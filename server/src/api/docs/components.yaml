schemas:
  User:
    type: object
    properties:
      id:
        type: integer
        format: int64
      username:
        type: string
        example: concertmasterkkb1
      firstName:
        type: string
        example: Liam
      lastName:
        type: string
        example: Cotton
      email:
        type: string
        format: email
        example: liam@cotton.com
      groups:
        type: array
        items:
          $ref: '#/schemas/GroupSummary'
      roles:
        type: array
        items:
          $ref: '#/schemas/RoleSummary'
      knownSongs:
        type: array
        items:
          $ref: '#/schemas/KnownSong'
      dietaryPreferences:
        type: string
        example: Vegetarian

    required:
      - id
      - username
      - firstName
      - lastName
      - email
      - groups
      - roles
      - knownSongs

  CSKVoice:
    type: string
    enum: [S, A, T, B, S1, S2, A1, A2, T1, T2, B1, B2]
    example: B1

  SongKnowledgeLevel:
    type: string
    enum: [PARTY, GIG, UTANTILL]
    example: UTANTILL

  SongKnowledge:
    type: object
    properties:
      voice:
        $ref: '#/schemas/CSKVoice'
      level:
        $ref: '#/schemas/SongKnowledgeLevel'
    required:
      - voice
      - level

  KnownSong:
    allOf:
      - $ref: '#/schemas/SongKnowledge'
      - type: object
        properties:
          song:
            $ref: '#/schemas/Song'
        required:
          - song

  RoleSummary:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string
        example: ADMIN
      description:
        type: string
        example: Administrator with full access
    required: [id, name]
  Role:
    allOf:
      - $ref: '#/schemas/RoleSummary'
      - type: object
        properties:
        groups:
          type: array
          items:
            type: integer
            format: int64
        user:
          type: object
          nullable: true
          properties:
            userId:
              type: integer
              format: int64
            name:
              type: string
              example: Liam Cotton
          required:
            - userId
            - name
        required:
          - groups
          - user

  GroupType:
    type: string
    enum: [VOICE, CHOIR, COMMITTEE, OTHER]
    example: VOICE

  GroupSummary:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string
        example: Tenor
      type:
        $ref: '#/schemas/GroupType'
    required: [id, name, type]

  Group:
    allOf:
      - $ref: '#/schemas/GroupSummary'
      - type: object
        properties:
          description:
            type: string
          members:
            type: array
            items:
              type: integer
              format: int64
          roles:
            type: array
            items:
              type: integer
              format: int64
          parents:
            type: array
            items:
              type: integer
              format: int64
          children:
            type: array
            items:
              type: integer
              format: int64
        required:
          - members
          - roles
          - parents
          - children

  Book:
    type: object
    properties:
      id:
        type: integer
        format: int64
      title:
        type: string
        example: Utantill
      songs:
        type: array
        items:
          $ref: '#/schemas/BookSong'
    required:
      - id
      - title

  BookSong:
    allOf:
      - $ref: '#/schemas/Song'
      - type: object
        properties:
          page:
            type: integer
            example: 50
        required:
          - page

  Song:
    type: object
    properties:
      id:
        type: integer
        format: int64
      title:
        type: string
        example: Island
      startingTones:
        type: string
        example: A3
      tags:
        type: array
        items:
          type: string
    required:
      - id
      - title

  CSKEventType:
    type: string
    enum: [REHEARSAL, CONCERT, GIG, PARTY, MEETING, OTHER]
    example: REHEARSAL

  CSKEventSummary:
    type: object
    properties:
      name:
        type: string
        example: Rep KK
      type:
        $ref: '#/schemas/CSKEventType'
      description:
        type: string
        example: Annual Christmas concert
      dateStart:
        type: string
        format: date-time
        example: 2023-12-24T18:00:00Z
      dateEnd:
        type: string
        format: date-time
        example: 2023-12-24T21:00:00Z
      place:
        type: string
        example: St. Paul's Church
      requiresAttendance:
        type: boolean
        example: true
      requiresRegistration:
        type: boolean
        example: false
    required:
      - name
      - type
      - dateStart
      - place
      - requiresAttendance
      - requiresRegistration

  CSKEvent:
    allOf:
      - $ref: '#/schemas/CSKEventSummary'
      - type: object
        properties:
          id:
            type: integer
            format: int64
          attendees:
            type: array
            items:
              $ref: '#/schemas/Attendance'
          registrations:
            type: array
            items:
              $ref: '#/schemas/Registration'
        required:
          - id

  CreateEventInput:
    $ref: '#/schemas/CSKEventSummary'

  AttendanceStatus:
    type: string
    enum: [PRESENT, ABSENT]
    example: PRESENT

  UpdateAttendanceInput:
    type: object
    properties:
      status:
        $ref: '#/schemas/AttendanceStatus'
      userId:
        type: integer
        format: int64
    required:
      - userId

  Attendance:
    type: object
    properties:
      userId:
        type: integer
        format: int64
      firstName:
        type: string
        example: Liam
      lastName:
        type: string
        example: Cotton
      status:
        $ref: '#/schemas/AttendanceStatus'
    required:
      - userId
      - firstName
      - lastName

  MakeRegistrationInput:
    type: object
    properties:
      userId:
        type: integer
        format: int64
      comments:
        type: string
        example: Looking forward to it!
      dietaryRestrictions:
        type: string
        example: Vegetarian
    required:
      - userId

  Registration:
    type: object
    properties:
      userId:
        type: integer
        format: int64
      firstName:
        type: string
        example: Liam
      lastName:
        type: string
        example: Cotton
      comments:
        type: string
        example: Looking forward to it!
      dietaryRestrictions:
        type: string
        example: Vegetarian
    required:
      - userId
      - firstName
      - lastName

  Tag:
    type: object
    properties:
      tagId:
        type: integer
        format: int64
      name:
        type: string
        example: Lucia
    required:
      - tagId
      - name

  Error:
    type: object
    properties:
      message:
        type: string
      code:
        type: string
    required:
      - message

  RegisterUserInput:
    type: object
    properties:
      username:
        type: string
        example: concertmasterkkb1
      firstName:
        type: string
        example: Liam
      lastName:
        type: string
        example: Cotton
      email:
        type: string
        example: liam@cotton.com
      password:
        type: string
        example: 'jagkansjunga'
    required:
      - firstName
      - lastName
      - email
      - username
      - password

  LoginUserInput:
    description: User credentials
    type: object
    properties:
      username:
        type: string
        example: concertmasterkkb1
      password:
        type: string
        example: 'jagkansjunga'
    required:
      - username
      - password

  UpdateUserInput:
    type: object
    properties:
      username:
        type: string
        example: concertmasterkkb1
      firstName:
        type: string
        example: Liam
      lastName:
        type: string
        example: Cotton
      email:
        type: string
        format: email
        example: liam@cotton.com
      dietaryPreferences:
        type: string
        example: Vegetarian

requestBodies:
  RegisterUser:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/RegisterUserInput'

  LoginUser:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/LoginUserInput'

  UpdateUser:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/UpdateUserInput'

  CreateEvent:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/CreateEventInput'

  UpdateAttendance:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/UpdateAttendanceInput'

  MakeRegistration:
    required: true
    content:
      application/json:
        schema:
          $ref: '#/schemas/MakeRegistrationInput'
